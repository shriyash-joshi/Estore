jQuery(function(_){"use strict";var a={get_geo_var:function(e){var t="#wcpbc-"+e,r=!1;return void 0!==_(t).data("value")&&_(t).data("value")&&-1<(r=_(t).data("value")).indexOf(",")&&(r=r.split(",").shift().trim()),r},isset_geo_country:function(){return a.get_geo_var("mm-country-code")||a.get_geo_var("http-cf-ipcountry")||a.get_geo_var("geoip-country-code")||a.get_geo_var("http-x-country-code")},x_forwarded_for_issue:function(){return!a.isset_geo_country()&&!a.get_geo_var("http-x-real-ip")&&a.get_geo_var("http-x-forwarded-for")&&a.get_geo_var("http-x-forwarded-for")!==a.get_geo_var("remote-addr")},get_first_ip_no_empty:function(){var r=!1;return["http-x-real-ip","http-x-forwarded-for","remote-addr"].forEach(function(e){var t=a.get_geo_var(e);!1===r&&!1!==t&&(r=t)}),r},remote_addr_test:function(){var e=a.get_geo_var("real-external-ip");_.post(wc_price_based_country_admin_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wc_price_based_country_admin_system_report_params.remote_addr_check_nonce,external_ip:e},function(e){"1"==e.result?a.get_geo_var("use-remote-addr")?a.append_result("ok"):a.append_result("fail",wc_price_based_country_admin_system_report_params.define_constant_alert):a.append_result("fail")})},first_ip_test:function(){var e=a.get_geo_var("real-external-ip"),t=a.get_first_ip_no_empty();_.post(wc_price_based_country_admin_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wc_price_based_country_admin_system_report_params.remote_addr_check_nonce,external_ip:e,remote_addr:t},function(e){"1"==e.result?a.append_result("ok"):a.append_result("fail",wc_price_based_country_admin_system_report_params.ip_no_match)})},append_result:function(e,t){var r="";switch(t=void 0===t?"":t,e){case"ok":r='<mark class="yes"><span class="dashicons dashicons-yes"></span></mark>';break;case"fail":r='<mark class="error"><span class="dashicons dashicons-warning"></span>'+t+"</mark>"}_("#wcpbc-geolocation-test td.wcpbc-geolocation-test-result").html(r)},geolocation_test:function(){a.isset_geo_country()||"yes"===a.get_geo_var("geoipdb-exists")?a.x_forwarded_for_issue()?a.get_geo_var("remote-addr")!==a.get_geo_var("real-external-ip")||a.get_geo_var("use-remote-addr")?a.remote_addr_test():a.append_result("fail",wc_price_based_country_admin_system_report_params.define_constant_alert):a.isset_geo_country()||a.get_first_ip_no_empty()===a.get_geo_var("real-external-ip")?a.append_result("ok"):a.first_ip_test():a.append_result("fail",wc_price_based_country_admin_system_report_params.geoipdb_required)},init:function(){_("#wcpbc-geolocation-debug").on("wc_price_based_country_real_external_ip_loaded",function(){a.geolocation_test()})}};a.init()});