jQuery(function(o){"use strict";var c={init:function(){o(document).ready(this.show_and_hide_panels),o("body").on("click",".wcpbc_price_method",this.price_method_change),o("body").on("click",'.wcpbc_sale_price_dates[type="radio"]',this.sale_dates_change),o("body").on("keyup",".wcpbc_sale_price[type=text]",this.sale_price_keyup),o("body").on("change",".wcpbc_sale_price[type=text]",this.sale_price_change),o(document.body).on("woocommerce_variations_added",this.show_and_hide_panels),o("#woocommerce-product-data").on("woocommerce_variations_loaded",this.show_and_hide_panels),o(document.body).on("wc_price_based_country_show_and_hide_panels",this.show_and_hide_panels),o(document).ready(this.product_type_not_supported_alert),o(document.body).on("woocommerce-product-type-change",this.product_type_not_supported_alert)},show_and_hide_panels:function(){o('.wcpbc_price_method[type="radio"][value="manual"]').each(function(){var e=o(this).closest(".wcpbc_pricing"),t=o(this).prop("checked");c.show_hide_price_controls(e,t)})},show_hide_price_controls:function(e,t){var c=t&&!e.find('.wcpbc_sale_price_dates[type="radio"][value="default"]').first().prop("checked");e.find(".wcpbc_show_if_manual").toggle(t),e.find(".wcpbc_hide_if_sale_dates_default").toggle(c),o(document.body).trigger("wc_price_based_country_manual_price_"+(t?"show":"hide"),[e])},price_method_change:function(){var e=o(this).closest(".wcpbc_pricing"),t="manual"==o(this).val();c.show_hide_price_controls(e,t)},sale_dates_change:function(){o(this).closest(".wcpbc_pricing").find(".wcpbc_hide_if_sale_dates_default").toggle("default"!==o(this).val())},is_sale_bigger_than_regular:function(e){var t=o("#"+e.attr("id").replace("_sale","_regular")),c=parseFloat(accounting.unformat(e.val(),woocommerce_admin.mon_decimal_point));return parseFloat(accounting.unformat(t.val(),woocommerce_admin.mon_decimal_point))<=c},sale_price_keyup:function(){c.is_sale_bigger_than_regular(o(this))?o(document.body).triggerHandler("wc_add_error_tip",[o(this),"i18n_sale_less_than_regular_error"]):o(document.body).triggerHandler("wc_remove_error_tip",[o(this),"i18n_sale_less_than_regular_error"])},sale_price_change:function(){c.is_sale_bigger_than_regular(o(this))&&o(this).val("")},product_type_not_supported_alert:function(){var e=o("select#product-type").val();o("#general_product_data .wc-price-based-country-upgrade-notice.wc-pbc-show-if-not-supported").hide(),o("#general_product_data .wc-price-based-country-upgrade-notice.wc-pbc-show-if-not-supported.product-type-"+e).toggle(o.inArray(e,wc_price_based_country_admin_params.product_type_supported)<0),o("#general_product_data .wc-price-based-country-upgrade-notice.wc-pbc-show-if-third-party").hide(),o("#general_product_data .wc-price-based-country-upgrade-notice.wc-pbc-show-if-third-party.product-type-"+e).toggle(0<=o.inArray(e,wc_price_based_country_admin_params.product_type_third_party))}},e={init:function(){this.discount_type_change(),o("#general_coupon_data #discount_type").on("change",this.discount_type_change)},discount_type_change:function(){var e="fixed_cart"==o("#discount_type").val()||"fixed_product"==o("#discount_type").val();o("#general_coupon_data #zone_pricing_type").closest("p").toggle(e)}},t={init:function(){o(".wcpbc-zone-settings").on("click",".select_eur",this.select_eur_click),o(".wcpbc-zone-settings").on("click",".select_eur_none",this.unselect_eur_click),o(".wcpbc-zone-settings").on("keyup","#name",this.zone_name_keyup),o(".wcpbc-zone-settings, table.pricingzones").on("click","a.wcpbc-delete-zone",this.delete_click),o("#wc_price_based_country_test_mode").on("change",this.test_mode_change),o("#wc_price_based_country_test_country").closest("tr").toggle(o("#wc_price_based_country_test_mode").is(":checked")),o(".wc-price-based-country-setting-wrapper-ads .wc-price-based-country-setting-content").append(o(".wc-price-based-country-setting-wrapper-ads").siblings("p.submit"))},select_eur_click:function(){var c=o(this).data("countries");return c instanceof Array&&(o(this).closest("td").find("select option").each(function(e,t){-1<c.indexOf(o(t).attr("value"))&&o(t).attr("selected","selected")}),o(this).closest("td").find("select").trigger("change")),!1},unselect_eur_click:function(){var c=o(this).data("countries");return(c=o(this).data("countries"))instanceof Array&&(o(this).closest("td").find("select option").each(function(e,t){-1<c.indexOf(o(t).attr("value"))&&o(t).removeAttr("selected")}),o(this).closest("td").find("select").trigger("change")),!1},zone_name_keyup:function(){var e=o(this).val();o(".wcpbc-zone-name").text(e||wc_price_based_country_admin_params.i18n_default_zone_name)},delete_click:function(e){confirm(wc_price_based_country_admin_params.i18n_delete_zone_alert)||e.preventDefault()},test_mode_change:function(){o("#wc_price_based_country_test_country").closest("tr").toggle(o(this).is(":checked"))}},i={init:function(){o(document.body).on("click",".wcpbc-upgrade-pro-popup",this.upgrade_pro_popup),o("select.variation_actions").on("wcpbc_variable_bulk_edit_popup",this.upgrade_pro_popup),o(document).ready(this.show_and_hide_pro_notice),o(document).ready(this.move_integration_upgrade_notices),o(document.body).on("woocommerce-product-type-change",this.show_and_hide_pro_notice),o(document.body).on("woocommerce_variations_added",this.show_and_hide_pro_notice),o("#woocommerce-product-data").on("woocommerce_variations_loaded",this.show_and_hide_pro_notice),o("input#_nyp").on("change",this.show_hide_nyp_notice),o("#woocommerce-product-data").on("change",".checkbox.variation_is_nyp",this.show_hide_nyp_notice)},upgrade_pro_popup:function(e){e.preventDefault();var t=o("#variable_product_options").find(".woocommerce_variations .variation-needs-update");0<t.length&&t.removeClass("variation-needs-update"),tb_show("Upgrade to Price Based on Country Pro now!","#TB_inline?width=600&height=350&inlineId=wcpbc-upgrade-pro-popup-content",!1),o("#TB_window").addClass("wcpbc-upgrade-pro-popup-content"),o("#TB_window").css({width:"600px",height:"400px"}),o("#TB_ajaxContent").css({width:"600px",height:"380px"}),o("#TB_window .button.button-primary").focus()},move_integration_upgrade_notices:function(){0<o(".wc-price-based-country-upgrade-germanized-integration").length&&(o("#general_product_data .wc-price-based-country-upgrade-germanized-integration").insertAfter("#general_product_data p._unit_price_sale_field"),o(document.body).on("woocommerce_variations_added",i.move_germanized_variation_divs),o("#woocommerce-product-data").on("woocommerce_variations_loaded",i.move_germanized_variation_divs)),0<o(".wc-price-based-country-upgrade-wc-smart-coupons-integration").length&&o("#general_product_data .wc-price-based-country-upgrade-wc-smart-coupons-integration").insertAfter("#sc-field")},move_germanized_variation_divs:function(){o(".woocommerce_variation.wc-metabox .variable_gzd_ts_labels").each(function(){var e=o(this).closest(".woocommerce_variation.wc-metabox");e.find(".wcpbc_pricing").insertAfter(o(this));var t=e.find(".variable_pricing_unit");e.find(".wc-price-based-country-upgrade-germanized-integration").insertAfter(t)})},show_and_hide_pro_notice:function(){var e=o("select#product-type").val();o(".wc-price-based-country-upgrade-notice:not(.show)").hide(),o(".wc-price-based-country-upgrade-notice.wc-pbc-show-if-"+e).show(),o("#general_product_data .wc-price-based-country-upgrade-notice.wc-price-based-country-upgrade-product-variable-subscription").hide(),o("#general_product_data .wc-price-based-country-upgrade-notice.wc-pbc-show-if-booking").hide(),i.show_hide_nyp_notice()},show_hide_nyp_notice:function(){if(!(o("input#_nyp").length<1)){var e=o("input#_nyp").prop("checked"),t=o("select#product-type").val();o(".wcpbc_pricing.hide_if_nyp-wcpbc").toggle(!e),o(".wc-price-based-country-upgrade-notice.wc-pbc-show-if-nyp-wcpbc").toggle(e),o(".checkbox.variation_is_nyp").each(function(){var e=o(this).prop("checked");o(this).closest(".woocommerce_variable_attributes.wc-metabox-content").find(".wc-price-based-country-upgrade-notice.wc-pbc-show-if-nyp-wcpbc").toggle(e),o(this).closest(".woocommerce_variable_attributes.wc-metabox-content").find(".wcpbc_pricing.hide_if_nyp-wcpbc").toggle(!e)}),e||o(".wcpbc_pricing.hide_if_"+t).hide()}}};"1"!==wc_price_based_country_admin_params.is_pro&&i.init(),c.init(),e.init(),t.init()});