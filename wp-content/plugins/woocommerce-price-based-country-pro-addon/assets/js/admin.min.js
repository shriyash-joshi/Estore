jQuery(function(s){"use strict";var c={init:function(){s(document.body).on("wc_price_based_country_manual_price_show",this.manual_price_show),s("select#product-type").on("change",this.show_and_hide_panels),s("input#_nyp").on("change",this.show_and_hide_panels),s("#woocommerce-product-data").on("change","input.variation_is_nyp",this.show_and_hide_variation_panels),s("#general_coupon_data #discount_type").on("change",this.coupon_type_change),s(document.body).ready(this.coupon_type_change),s("select.variation_actions").on("wcpbc_variable_bluck_edit_ajax_data",this.variable_bluck_edit),this.subscriptions_init(),this.bookings_init(),this.addons_init(),this.german_market_init(),this.germanized.init()},show_and_hide_panels:function(){s(document.body).trigger("wc_price_based_country_show_and_hide_panels")},show_and_hide_variation_panels:function(){s(this).closest(".woocommerce_variation").find('.wcpbc_price_method[type="radio"][value="manual"]').each(function(){var e=s(this).prop("checked"),i=s(this).closest(".wcpbc_pricing");e&&c.manual_price_show(!1,i)})},manual_price_show:function(e,i){var c=s("select#product-type").val(),o=!i.find('.wcpbc_sale_price_dates[type="radio"][value="default"]').first().prop("checked"),_=wc_price_based_country_pro_admin_param.name_your_price_support&&s("input#_nyp").prop("checked"),n=wc_price_based_country_pro_admin_param.subscription_support&&("subscription"===c||"variable-subscription"===c);wc_price_based_country_pro_admin_param.name_your_price_support&&(i.closest(".woocommerce_variation").length&&(_=i.closest(".woocommerce_variation").find("input.variation_is_nyp").first().prop("checked")),i.find(".wcpbc_show_if_nyp").toggle(_),i.find(".wcpbc_show_if_manual").not(".wcpbc_show_if_nyp").toggle(!_),i.find(".wcpbc_show_if_manual.wcpbc_hide_if_sale_dates_default").not(".wcpbc_show_if_nyp").toggle(!_&&o),_?i.find(".wcpbc_input_subscription_price").prop("disabled",!0).css("background","#ccc"):i.find(".wcpbc_input_subscription_price").prop("disabled",!1).css("background","#fff")),wc_price_based_country_pro_admin_param.subscription_support&&(i.find(".wcpbc_show_if_manual_subscription").toggle(n),n&&i.find("._regular_price_wcpbc_field, ._variable_regular_price_wcpbc_field").hide(),i.find("._variable_sale_price_wcpbc_field").toggleClass("form-row-last",!n))},coupon_type_change:function(){var e=s.inArray(s("#general_coupon_data #discount_type").val(),["percent","sign_up_fee_percent","recurring_percent"]);s("#general_coupon_data .options_group.wcpbc_pricing").toggle(e<0)},subscriptions_init:function(){wc_price_based_country_pro_admin_param.subscription_support&&(s(document.body).ready(this.move_subscriptions_fields),s(document.body).on("woocommerce_variations_added",this.move_subscriptions_fields),s("#woocommerce-product-data").on("woocommerce_variations_loaded",this.move_subscriptions_fields),s("#woocommerce-product-data").on("change",".wcpbc_pricing .wcpbc_input_subscription_price",function(){var e="#"+s(this).attr("id").replace("_subscription_price","_regular_price");s(e).val(s(this).val())}))},move_subscriptions_fields:function(){s("#woocommerce-product-data .wcpbc_show_if_manual_subscription").not("wcs_moved").each(function(){s(this).closest(".wcpbc_pricing").find("._variable_regular_price_wcpbc_field").before(s(this)),s(this).closest(".wcpbc_pricing").find("._regular_price_wcpbc_field").before(s(this)),s(this).addClass("wcs_moved")})},bookings_init:function(){s("#pricing_rows").on("change",".wc_booking_pricing_type select",function(e){void 0!==e.originalEvent&&c.booking_pricing_rows_change()}),s("#bookings_resources").on("change",".booking_resource_price_method",function(){var e="exchange_rate"==s(this).val()?"hidden":"visible";s(this).closest("tr").find(".booking_resource_cost").css("visibility",e)}),s("#bookings_persons").on("change",".booking_person_price_method",function(){var e="exchange_rate"==s(this).val()?"hidden":"visible";s(this).closest("tr").find(".booking_person_cost").css("visibility",e)}),s("li.wcpbc_bookings_pricing_options.wcpbc_bookings_pricing_tab.show_if_booking").insertAfter("li.bookings_pricing_options.bookings_pricing_tab.show_if_booking"),s("li.wcpbc_accommodation_bookings_rates_tab.show_if_accommodation-booking").insertAfter("li.accommodation_bookings_pricing_tab.show_if_accommodation-booking")},booking_pricing_rows_change:function(){s("#wcpbc_bookings_pricing .table_grid").hide(),s("#wcpbc_bookings_pricing .pricing_warning").show()},addons_init:function(){s("#wcpbc_product_addons_data select.wcpbc-price-method").on("change",function(){var e=s(this).closest("div.wcpbc-pao-addon"),i=s(this).val();e.toggleClass("closed","manual"!==i)}),s("#product_addons_data").on("change","select.wc-pao-addon-type-select, .wc-pao-addon-option-price-type, .wc-pao-addon-content-price input, .wc-pao-addon-adjust-price, .wc-pao-addon-adjust-price-select, .wc-pao-addon-adjust-price-value, .wc-pao-addon-min-max input",function(e){void 0===e.isTrigger&&(s("#wcpbc_product_addons_data .wc-metaboxes").hide(),s("#wcpbc-addons-update-required").show())})},german_market_init:function(){s('<div class="options_group"></div>').appendTo("#woocommerce-product-data #price_per_unit_options"),s("#woocommerce-product-data #price_per_unit_options p.form-field").appendTo("#woocommerce-product-data #price_per_unit_options .options_group"),s(".wcpbc_price_per_unit_options").appendTo("#woocommerce-product-data #price_per_unit_options")},germanized:{init:function(){s(document.body).on("woocommerce_variations_added",c.germanized.move_pricing_fields),s("#woocommerce-product-data").on("woocommerce_variations_loaded",c.germanized.move_pricing_fields),s(document.body).on("click","#_unit_price_auto",c.germanized.enable_disable_unit_price_fields),s(document).ready(function(){s("#general_product_data #_unit_price_auto").each(c.germanized.enable_disable_unit_price_fields)})},move_pricing_fields:function(){s(".woocommerce_variation.wc-metabox .variable_gzd_ts_labels").each(function(){s(this).closest(".woocommerce_variation.wc-metabox").find(".wcpbc_pricing").insertAfter(s(this))})},enable_disable_unit_price_fields:function(){s(this).is(":checked")?(s(this).closest("#general_product_data").find("._unit_price_regular_wcpbc_field input").attr("readonly","readonly"),s(this).closest("#general_product_data").find("._unit_price_sale_wcpbc_field input").attr("readonly","readonly")):(s(this).closest("#general_product_data").find("._unit_price_regular_wcpbc_field input").removeAttr("readonly"),s(this).closest("#general_product_data").find("._unit_price_sale_wcpbc_field input").removeAttr("readonly"))}},variable_bluck_edit:function(){var e,i={action:s("select.variation_actions option:selected").data("action"),zone_id:s("select.variation_actions option:selected").data("zone-id")};switch(i.action){case"regular_price_increase":case"regular_price_decrease":case"sale_price_increase":case"sale_price_decrease":null!=(e=window.prompt(wc_price_based_country_pro_admin_param.i18n_enter_a_value_fixed_or_percent))&&(0<=e.indexOf("%")?i.value=accounting.unformat(e.replace(/\%/,""),woocommerce_admin.mon_decimal_point)+"%":i.value=accounting.unformat(e,woocommerce_admin.mon_decimal_point));break;case"regular_price":case"sale_price":null!=(e=window.prompt(wc_price_based_country_pro_admin_param.i18n_enter_a_value))&&(i.value=e)}return i}},o={init:function(){s("#woocommerce-order-items").on("click","button.wcpbc-load-pricing-action",this.load_country_pricing)},block:function(){s("#woocommerce-order-items").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},refresh:function(e){s("#woocommerce-order-items").find(".inside").empty(),s("#woocommerce-order-items").find(".inside").append(e),s("#tiptip_holder").removeAttr("style"),s("#tiptip_arrow").removeAttr("style"),s(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),s("#woocommerce-order-items").unblock(),s(".woocommerce_order_items").stupidtable(),s(".woocommerce_order_items").on("aftertablesort",this.add_arrows)},add_arrows:function(e,i){var c=s(this).find("th"),o="asc"===i.direction?"&uarr;":"&darr;",_=i.column;c.find(".wc-arrow").remove(),c.eq(_).append('<span class="wc-arrow">'+o+"</span>")},load_country_pricing:function(){if("undefined"!=typeof woocommerce_admin_meta_boxes&&window.confirm(wc_price_based_country_pro_admin_param.i18n_load_country_pricing_confirm)){var e={country:"",state:"",postcode:"",city:""};"shipping"===woocommerce_admin_meta_boxes.tax_based_on&&(e.country=s("#_shipping_country").val(),e.state=s("#_shipping_state").val(),e.postcode=s("#_shipping_postcode").val(),e.city=s("#_shipping_city").val()),"billing"!==woocommerce_admin_meta_boxes.tax_based_on&&e.country||(e.country=s("#_billing_country").val(),e.state=s("#_billing_state").val(),e.postcode=s("#_billing_postcode").val(),e.city=s("#_billing_city").val());var i={action:"wc_price_based_country_load_country_pricing",order_id:woocommerce_admin_meta_boxes.post_id,billing_country:s("#_billing_country").val(),shipping_country:s("#_shipping_country").val(),items:s("table.woocommerce_order_items :input[name], .wc-order-totals-items :input[name]").serialize(),tax_args:e,security:wc_price_based_country_pro_admin_param.load_country_pricing_nonce};o.block(),s.ajax({url:wc_price_based_country_pro_admin_param.ajax_url,data:i,type:"POST",success:function(e){o.refresh(e)}})}}},e={init:function(){s("#woocommerce_currency_pos").closest("tr").hide(),s(".wcpbc-zone-settings #exchange_rate").closest("tr").insertAfter(s('input[name="auto_exchange_rate"]').closest("tr")),s("#exchange_rate").closest("tr").toggle("no"==s('input[name="auto_exchange_rate"]:checked').val()),s("#exchange_rate_fee").closest("tr").toggle("yes"==s('input[name="auto_exchange_rate"]:checked').val()),s('input[name="auto_exchange_rate"]').on("click",function(){s("#exchange_rate").closest("tr").toggle("no"==s(this).val()),s("#exchange_rate_fee").closest("tr").toggle("yes"==s(this).val())}),0<s("#wc_price_based_currency_format_preview").length&&(s("#woocommerce_currency").addClass("wc_price_based_country_preview_currency"),s('.settings-panel.wcpbc-zone-settings select[name="currency"]').addClass("wc_price_based_country_preview_currency"),s("#wc_price_based_currency_format").addClass("wc_price_based_country_preview_format"),s("#woocommerce_price_num_decimals").addClass("wc_price_based_country_preview_num_decimals"),s("#woocommerce_price_decimal_sep").addClass("wc_price_based_country_preview_decimal_sep"),this.price_preview()),s(".wc_price_based_country_preview_currency, .wc_price_based_country_preview_format, .wc_price_based_country_preview_num_decimals, .wc_price_based_country_preview_decimal_sep").on("change",function(){e.price_preview()}),s("select#wc_price_based_country_exchange_rate_api").on("change",this.show_if_exchange_rate),this.show_if_exchange_rate()},price_preview:function(){var e=s(".wc_price_based_country_preview_currency:first option:selected").text(),i=s(".wc_price_based_country_preview_currency:first option:selected").val(),c=s(".wc_price_based_country_preview_format:first").val();c||(c=s("#wc_price_based_currency_format_preview").data("default"));var o=parseInt(s(".wc_price_based_country_preview_num_decimals:first").val()),_=s(".wc_price_based_country_preview_decimal_sep:first").val(),n="99"+(0<o?_:"")+"9".repeat(o),r=e.lastIndexOf("(");if(-1<r){e=e.substr(r+1).replace(")",""),c.indexOf("[price]")<0&&(c+="[price]");var a=void 0===wc_price_based_country_pro_admin_param.alt_currency_symbols[i]?e:wc_price_based_country_pro_admin_param.alt_currency_symbols[i],t=c.replace("[price]",n);t=(t=(t=t.replace("[code]",i)).replace("[symbol]",e)).replace("[symbol-alt]",a),s("#wc_price_based_currency_format_preview").html(t)}},show_if_exchange_rate:function(){var e=s("select#wc_price_based_country_exchange_rate_api").val();void 0!==e&&(s(".wcpbc_exchange_rate_option").closest("tr").hide(),s(".wcpbc_exchange_rate_option.show_if_exchange_rate_"+e).closest("tr").show())}};c.init(),"undefined"!=typeof woocommerce_admin_meta_boxes&&o.init(),e.init()});